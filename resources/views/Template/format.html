<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; font-size: 9px; }
        .header-table, .main-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
        .main-table th, .main-table td { border: 1px solid #000; padding: 3px; text-align: center; }
        .bg-gray { background-color: #D9D9D9; font-weight: bold; }
        .pass { background-color: #C6EFCE; } /* Verde suave */
        .fail { background-color: #FFFFC7CE; } /* Rojo suave */
        .title { font-size: 14px; font-weight: bold; text-align: center; background-color: #D9D9D9; }
    </style>
</head>
<body>
    <table class="header-table">
        <tr><td colspan="4" class="title">SMITH MASON & CO - TRAINING ROSTER</td></tr>
        <tr>
            <td class="bg-gray">Project ID:</td><td>{{ $proyecto->ID_PROJECT }}</td>
            <td class="bg-gray">Entity:</td><td>{{ $entidad }}</td>
        </tr>
        <tr>
            <td class="bg-gray">Exam Date:</td><td>{{ $proyecto->EXAM_DATE_PROJECT }}</td>
            <td class="bg-gray">Limit Date:</td><td>{{ $fecha_vencimiento_limite }}</td>
        </tr>
    </table>

    <table class="main-table">
        <thead>
            <tr class="bg-gray">
                <th rowspan="2">Candidate Name</th>
                <th rowspan="2">Level</th>
                <th colspan="3">Assessment Modules</th>
                <th rowspan="2">Resit Score</th>
                <th rowspan="2">Final Status</th>
                <th rowspan="2">Expiration</th>
            </tr>
            <tr class="bg-gray">
                <th>Module</th>
                <th>Score</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            @foreach($estudiantes as $e)
                @php 
                    $statusClass = ($e->FINAL_STATUS == 'PASS' || $e->FINAL_STATUS == '1') ? 'pass' : 'fail';
                @endphp
                <tr class="{{ $statusClass }}">
                    <td rowspan="3">
                        {{ $e->LAST_NAME_PROJECT }}, {{ $e->FIRST_NAME_PROJECT }} {{ $e->MIDDLE_NAME_PROJECT }}
                    </td>
                    <td rowspan="3">{{ $e->LEVEL }}</td>
                    <td>Practical</td>
                    <td>{{ $e->PRACTICAL }}%</td>
                    <td>{{ $e->PRACTICAL_PASS }}</td>
                    <td rowspan="3">{{ $e->RESIT_INMEDIATO_SCORE ? $e->RESIT_INMEDIATO_SCORE.'%' : 'N/A' }}</td>
                    <td rowspan="3"><strong>{{ $e->FINAL_STATUS }}</strong></td>
                    <td rowspan="3">{{ $e->EXPIRATION }}</td>
                </tr>
                <tr class="{{ $statusClass }}">
                    <td>Equipment</td>
                    <td>{{ $e->EQUIPAMENT }}%</td>
                    <td>{{ $e->EQUIPAMENT_PASS }}</td>
                </tr>
                <tr class="{{ $statusClass }}">
                    <td>P&P</td>
                    <td>{{ $e->PYP }}%</td>
                    <td>{{ $e->PYP_PASS }}</td>
                </tr>
            @endforeach
        </tbody>
    </table>
</body>
</html>